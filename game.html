<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link
    href="https://fonts.googleapis.com/css2?family=Alfa+Slab+One&family=Dela+Gothic+One&family=Mochiy+Pop+P+One&family=Secular+One&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
  <title>Document</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      height: 100vh;
      width: 100vw;
      display: flex;
      flex-wrap: nowrap;
      justify-content: space-around;
      align-items: center;
      box-sizing: border-box;
      overflow: hidden;
      font-family: 'Alfa Slab One', cursive;
    }


    #man {
      background-color: #fff;
      position: absolute;
      width: 97vw;
      z-index: 0;
      left: -69px;
      z-index: 2;
      transform: translateY(33%);
    }

    .entrance {
      animation: entrance 5s ease-out forwards;
    }

    @keyframes entrance {
      0% {
        transform: translateY(33%);
      }

      100% {
        transform: translateY(-10%);
      }
    }

    #text {
      opacity: 0;
      position: absolute;
      top: 20%;
      right: 0;
      left: 0;
      margin: auto;
      transition: 1s;
      z-index: 2;
    }

    #start {
      opacity: 0;
      width: 150px;
      height: 16px;
      text-align: center;
      position: absolute;
      top: 56%;
      left: 0;
      right: 0;
      margin: auto;
      z-index: 2;
    }

    #game {
      width: 69%;
      height: 97%;
      /* border: 3px solid #000; */
      display: flex;
      justify-content: space-evenly;
      align-items: center;
      flex-wrap: wrap;
      padding: 56px;
      box-sizing: border-box;
    }

    .card {
      width: 23%;
      height: 30%;
      /* border: 1px solid #000; */
      border-radius: 15px;
      position: relative;
      transform-style: preserve-3d;
      transition: transform 1s;
    }

    .front {
      position: absolute;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      /* background: url(./cropped/c11.png)no-repeat center center/contain; */
      backface-visibility: hidden;
      border-radius: 15px;

    }

    .back {
      position: absolute;
      width: 100%;
      height: 100%;
      background-color: rgb(255 213 0);
      display: flex;
      justify-content: center;
      align-items: center;
      backface-visibility: hidden;
      transform: rotateY(180deg);
      border-radius: 15px;

    }

    .close {
      transform: rotateY(180deg);
    }

    .card:not(.close) {
      pointer-events: none;
    }

    #avatar {
      width: 29%;
      height: 97%;
      /* border: 3px solid #000; */
      display: flex;
      justify-content: center;
      align-items: end;
      transition: 1.5s;
    }

    #avatar img {
      position: absolute;
      height: 80vh;
    }

    #score {
      /* display: flex; */
      flex-direction: column;
      justify-content: space-evenly;
      align-items: center;
      display: none;
      width: 50vw;
    }

    .front img,
    .back img {
      width: 100%;
    }
  </style>
</head>

<body>
  <img id="man" src="./cropped/bman.png">
  <svg version="1.1" id="text" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px"
    y="0px" width="850px" height="200px" viewBox="0 0 1155.225 333.695" enable-background="new 0 0 1155.225 333.695"
    xml:space="preserve" class="animate__fadeInUp">
    <g>
      <path d="M76.154,172.418l-3.351,4.316l61.687,36.016l3.354-4.306l22.485,13.121l-25.36,32.612l-22.481-13.124l3.219-4.141
     l-22.623-13.205l-9.389,12.078l22.621,13.205l3.218-4.141l22.48,13.132l-25.358,32.613l-22.48-13.132l3.355-4.311l-61.691-36.018
     l-3.353,4.309L0,228.327l25.36-32.621l22.487,13.127l-3.223,4.146l20.839,12.155l9.393-12.076l-20.837-12.159l-3.223,4.14
     l-22.482-13.132L53.675,159.3L76.154,172.418z" />
      <path d="M160.889,212.629c-10.229-1.676-20.545-7.645-30.95-17.904c-10.408-10.258-15.917-19.882-16.526-28.889
     c-0.613-9.012,3.348-16.769,11.887-23.271c8.476-6.46,17.269-8.482,26.373-6.067c9.104,2.406,17.622,7.516,25.552,15.341
     l7.858,7.737l-29.212,22.262l0.653,0.645c2.691,2.657,5.333,4.104,7.933,4.354c2.594,0.245,5.424-0.805,8.493-3.136
     c3.661-2.797,6.822-5.77,9.474-8.931c2.652-3.172,4.704-6.193,6.151-9.076l17.458,17.216c-0.721,2.965-2.541,6.548-5.476,10.753
     c-2.934,4.199-6.77,8.114-11.521,11.731C180.501,211.896,171.118,214.309,160.889,212.629z M154.325,162.03l-1.313-1.288
     c-2.471-2.433-4.693-3.858-6.658-4.271c-1.962-0.419-3.814,0.047-5.557,1.375c-1.745,1.321-2.486,2.877-2.229,4.649
     c0.253,1.782,1.582,3.853,3.982,6.21l1.313,1.296L154.325,162.03z" />
      <path d="M212.051,186.678l-15.1-19.688l4.397-2.534l-41.186-53.671l-4.399,2.525l-15.011-19.553l27.396-15.79l56.196,73.243
     l4.395-2.533l15.105,19.676L212.051,186.678z" />
      <path
        d="M247.422,174.935l4.727-2.051l-33.314-57.633l-4.723,2.042l-12.14-20.999l29.41-12.767l5.037,8.708
     c0.212-3.507,1.11-6.938,2.71-10.306c1.591-3.354,4.21-5.836,7.858-7.422c7.303-3.162,14.67-2.304,22.106,2.582
     c7.433,4.896,14.609,13.317,21.52,25.263c6.907,11.959,10.394,21.983,10.461,30.066c0.062,8.095-3.554,13.721-10.854,16.891
     c-3.648,1.586-7.505,1.921-11.564,1.018c-4.063-0.906-7.777-2.34-11.146-4.3l9.335,16.141l7.4-3.217l12.14,21.001l-36.817,15.984
     L247.422,174.935z M270.152,127.021c0.276-1.774-0.406-4.075-2.035-6.894l-7.4-12.803c-1.626-2.818-3.343-4.663-5.147-5.541
     c-1.801-0.866-3.743-0.857-5.816,0.045c-2.078,0.897-3.249,2.238-3.525,4.014c-0.266,1.77,0.405,4.067,2.035,6.88l7.407,12.816
     c1.629,2.816,3.337,4.664,5.141,5.53c1.802,0.878,3.746,0.863,5.823-0.039C268.704,130.127,269.876,128.794,270.152,127.021z" />
      <path d="M336.131,104.565l5.811-1.327L323.1,41.028l-5.807,1.325l-6.923-22.857l47.147-10.726
     c12.928-2.938,24.486-1.055,34.671,5.659c10.192,6.726,18.166,19.596,23.924,38.621c5.765,19.032,6.108,33.636,1.049,43.819
     c-5.07,10.193-14.066,16.75-26.995,19.697l-47.15,10.716L336.131,104.565z M381.192,94.316c2.632-0.597,4.355-1.876,5.167-3.845
     c0.814-1.957,0.688-4.691-0.377-8.204l-12.671-41.846c-2.068-6.835-5.738-9.65-11-8.458l-6.735,1.538l18.881,62.342L381.192,94.316
     z" />
      <path d="M498.609,76.212l3.612,23.279l-31.416,3.665l-1.495-9.652c-1.275,3.229-3.298,6.21-6.066,8.941
     c-2.766,2.737-6.407,4.357-10.925,4.889c-5.95,0.692-10.929-0.653-14.928-4.039c-3.998-3.392-6.534-8.539-7.602-15.45
     c-2.778-17.889,8.533-28.548,33.918-31.987c-0.736-3.192-2.109-5.271-4.115-6.247c-2.01-0.962-5.196-1.198-9.556-0.692
     c-3.577,0.419-7.333,1.313-11.275,2.684c-3.946,1.384-7.511,3.026-10.688,4.933l-4.047-26.117
     c4.015-1.716,8.419-3.246,13.216-4.582c4.801-1.324,9.543-2.268,14.224-2.804c11.824-1.381,20.668,0.183,26.54,4.708
     c5.865,4.521,9.633,12.125,11.295,22.821l4.076,26.259L498.609,76.212z M465.652,69.938c-3.57,0.41-6.238,1.308-8.001,2.666
     c-1.772,1.361-2.45,3.369-2.034,6.019c0.249,1.612,0.866,2.86,1.853,3.758c0.99,0.892,2.233,1.258,3.742,1.08
     c2.062-0.241,3.486-1.465,4.271-3.673c0.786-2.214,0.887-5.215,0.302-9.001L465.652,69.938z" />
      <path
        d="M517.967,99.099l-17.518-55.625l-5.036,0.157l-1.007-23.475l37.083-1.192l0.989,23.475l-5.033,0.165l7.575,28.138
     l1.185-0.039l5.164-28.546l-5.034,0.157l-1.013-23.47l34.808-1.12l0.989,23.471l-5.04,0.169L553.725,97.95L517.967,99.099z" />
      <path d="M583.593,89.325c-5.897-7.44-8.368-17.979-7.394-31.612c0.967-13.624,4.891-23.816,11.782-30.589
     c6.896-6.754,16.011-9.839,27.357-9.234c11.263,0.599,19.146,4.534,23.642,11.796c4.499,7.276,6.382,16.108,5.647,26.495
     l-0.729,10.297l-38.825-2.062l-0.059,0.857c-0.257,3.527,0.444,6.177,2.077,7.929c1.648,1.764,4.499,2.754,8.578,2.977
     c4.876,0.25,9.532,0.072,13.992-0.552c4.454-0.627,8.361-1.519,11.74-2.678l-1.626,22.878c-2.918,1.659-7.134,3.086-12.623,4.278
     c-5.502,1.187-11.405,1.614-17.712,1.279C598.085,100.786,589.48,96.767,583.593,89.325z M620.084,49.433l0.13-1.716
     c0.225-3.248-0.194-5.619-1.249-7.107c-1.056-1.484-2.746-2.298-5.061-2.415c-2.323-0.124-4.108,0.523-5.368,1.938
     c-1.27,1.417-2.003,3.695-2.229,6.837l-0.114,1.716L620.084,49.433z" />
      <path d="M691.961,107.539c-6.286-2.826-10.99-5.558-14.08-8.207l7.082-27.688l25.791,4.942c-0.747,2.895-0.733,5.103,0.029,6.612
     c0.763,1.522,2.584,2.548,5.479,3.105c2.421,0.467,4.271,0.354,5.551-0.326c1.285-0.681,2.154-1.913,2.606-3.682
     c0.376-1.494,0.191-2.875-0.536-4.141c-0.746-1.263-2.229-2.697-4.437-4.301l-9.017-6.125
     c-7.674-5.577-12.724-11.397-15.155-17.431c-2.431-6.044-2.496-13.587-0.182-22.636c2.812-10.994,7.975-18.788,15.496-23.358
     c7.521-4.57,18.36-5.504,32.502-2.79c6.801,1.309,12.977,3.347,18.54,6.128c5.566,2.78,9.838,5.876,12.82,9.276l-6.403,25.041
     l-23.44-4.506c1.181-4.652-0.634-7.447-5.479-8.385c-2.344-0.444-4.096-0.419-5.252,0.1c-1.158,0.511-1.957,1.65-2.411,3.42
     c-0.409,1.583-0.159,2.952,0.733,4.103c0.893,1.147,2.496,2.492,4.813,4.012l9.124,6.146c7.423,4.95,12.354,10.466,14.777,16.552
     c2.418,6.09,2.516,13.467,0.302,22.138c-3.027,11.845-8.653,20.155-16.878,24.929c-8.23,4.784-18.799,5.93-31.693,3.46
     C705.146,112.492,698.245,110.357,691.961,107.539z" />
      <path d="M835.533,120.333l-9.146,22.113l-30.961-9.625l4.346-10.511c-8.845,6.585-17.339,8.606-25.473,6.078
     c-6.251-1.938-9.978-5.732-11.172-11.377c-1.194-5.647-0.097-12.559,3.281-20.737l11.775-28.453l-4.972-1.546l9.146-22.113
     l30.961,9.614L795.026,98.01c-1.227,2.967-1.581,5.313-1.064,7.048c0.513,1.735,1.872,2.939,4.057,3.62
     c2.185,0.679,4.113,0.492,5.777-0.567c1.669-1.056,3.122-3.061,4.35-6.025l9.149-22.121l-6.105-1.893l9.149-22.113l32.091,9.968
     l-21.869,52.86L835.533,120.333z" />
      <path
        d="M826.214,143.397l11.838-21.132l4.755,1.997l16.456-29.378l-4.749-2.005l11.844-21.132l29.595,12.46l-28.307,50.51
     l4.746,1.991l-11.837,21.137L826.214,143.397z M875.514,66.843l12.055-21.516l22.042,9.27l-12.064,21.522L875.514,66.843z" />
      <path d="M873.706,158.141c-0.711-6.126,2.421-14.167,9.416-24.124l15.54-22.151l-4.508-2.378l14.073-20.078
     c2.606,1.369,5.115,1.605,7.521,0.7c2.425-0.903,4.608-2.751,6.56-5.521l3.862-5.513l21.749,11.462l-10.139,14.447l13.849,7.291
     l-14.083,20.079l-13.853-7.302l-14.083,20.079c-1.89,2.687-2.781,4.926-2.684,6.714c0.106,1.789,1.151,3.209,3.132,4.251
     c2.606,1.363,5.689,2.491,9.288,3.386l-13.485,19.213c-2.538-0.112-5.716-0.636-9.503-1.566c-3.785-0.942-7.361-2.292-10.718-4.056
     C878.399,169.247,874.417,164.277,873.706,158.141z" />
      <path d="M949.468,200.777c0.841-8.831,7.481-18.324,19.91-28.48l40.301-32.902l-4.108-3.786l19.728-16.113l30.464,28.021
     l-19.737,16.106l-3.291-3.021l-46.439,37.908c-2.645,2.166-4.197,4.112-4.635,5.867c-0.451,1.744,0.116,3.347,1.711,4.813
     c1.594,1.463,3.407,2.059,5.442,1.772c2.048-0.281,4.382-1.502,7.027-3.665l46.449-37.917l-3.294-3.023l19.728-16.116
     l28.238,25.983l-19.729,16.102l-4.119-3.786l-40.302,32.902c-12.435,10.159-23.696,15.398-33.781,15.726
     c-10.098,0.326-19.396-3.423-27.897-11.248C952.516,217.993,948.631,209.611,949.468,200.777z" />
      <path
        d="M982.068,253.713l2.389,4.081l66.353-29.136l-2.389-4.08l24.181-10.612l14.865,25.428l-10.021,4.402
     c4.049,0.157,8.018,0.937,11.903,2.295c3.885,1.362,6.751,3.628,8.598,6.778c3.693,6.314,2.727,12.702-2.882,19.166
     c-5.609,6.471-15.291,12.718-29.057,18.766c-13.765,6.038-25.313,9.11-34.642,9.202c-9.335,0.093-15.843-3.012-19.532-9.326
     c-1.851-3.153-2.253-6.5-1.23-10.016c1.025-3.524,2.658-6.753,4.911-9.682l-18.585,8.163l3.742,6.403l-24.182,10.612l-18.61-31.835
     L982.068,253.713z M1037.46,273.182c2.054,0.233,4.699-0.362,7.938-1.791l14.746-6.472c3.249-1.427,5.368-2.92,6.371-4.485
     c0.99-1.564,0.967-3.244-0.074-5.044c-1.059-1.794-2.606-2.81-4.651-3.032c-2.055-0.222-4.693,0.374-7.943,1.792l-14.745,6.48
     c-3.235,1.418-5.368,2.922-6.357,4.486c-1.001,1.555-0.98,3.245,0.074,5.037C1033.863,271.941,1035.412,272.957,1037.46,273.182z" />
      <path d="M1022.812,310.784l26.417-5.279l6.092,22.912l-26.42,5.278L1022.812,310.784z M1058.359,304.751l80.754-21.032l8.05-1.604
     l8.062,30.319l-8.05,1.604l-83.266,11.603L1058.359,304.751z" />
    </g>
  </svg>
  <div id="start">START</div>
  </div>

  <div id="game">

  </div>
  <div id="avatar">
    <div id="countdown"><span id="mm">00</span>:<span id="ss">00</span> </div>
    <img src="./img/man.png">
  </div>

  <div id="score" class="animate__slideInRight">
    Score: <span id="scoreText">00</span>
    <div id="ok">ok</div>
  </div>

  <script src="./jquery-3.6.4.min.js"></script>
  <script>
    window.onload = () => {
      $('#man').addClass('entrance')
      setTimeout(() => {
        $('#text').css('opacity', '1')
      }, 5000)
      setTimeout(() => {
        $('#start').css('opacity', '1')
      }, 6000)
    }
    let arr1 = []
    let arr2 = []
    // append 12 cards to #game
    for (let i = 0; i < 12; i++) {
      $('#game').append(`
        <div class="card close">
            <div class="front"><img src="./img/1.png"></div>
            <div class="back"><img src="./img/cat.png"></div>
        </div>
            `)
    }

    for (let i = 0; i < 12; i++) {
      // const num = i % 12 + 1
      // set the front of the cards
      $('.card').eq(i).find('.front img').attr('src', `./cropped/${i + 1}.png`)
      // assign their IDs to data-card
      $('.card').eq(i).attr('data-card', i + 1)
      const target = Math.round(Math.random() * 11)
      // 洗牌
      $('.card').eq(target).insertAfter($('.card').eq(i))
    }

    $('#start').on('click', function () {
      arr1 = []
      arr2 = []
      $('#start').css('display', 'none')
      $('#man').css('display', 'none')
      $('#text').css('display', 'none')
      $('#mm').text('01')

      // open cards
      $('.card').each(function (i, card) {
        $(this).removeClass('close')
      })

      setTimeout(function () {
        // close cards after 3s
        $('.card').each(function (i, card) {
          $(this).addClass('close')
        })
        // set countdown timer
        $('#mm').text('00')
        $('#ss').text('59')
        let s = 59
        let interval = setInterval(function () {
          $('#ss').text(String(s--).padStart(2, '0'))

          // scoring
          if ($('#ss').text() == 0 || $('.close').length == 0) {
            $('#countdown').css('display', 'none')
            $('#game').css('width', '0px')
            $('#game').css('transition', '0.5s')
            $('#score').css('display', 'flex')
            clearInterval(interval)
            $('#scoreText').text(scoring(s, $('.close').length, arr1, arr2))
          }
        }, 1000)
      }, 3000)
    })

    $('#game').on('click', '.card', function () {
      $(this).removeClass('close')

      let i = $(this).attr('data-card')
      if (i <= 5) {
        arr1.push(i)
      } else if (i > 5 && i <= 9) {
        arr2.push(i)
      }
      $('#avatar').append('<img src=`./img/1.png`>')
      $('#avatar img').last().attr('src', `./img/${i}.png`)
    })

    $('#ok').on('click', function () {
      location.reload()
    })

    function scoring(s, closedLength, arr1, arr2) {
      s = s >= 40 ? 0 : (39 - s) //剩餘秒數大於40不扣分，少於40則少一秒扣一分
      return (100 - s - (closedLength * 5) - sort(arr1) - sort(arr2))
    }


    function sort(arr) {
      let count = 0
      for (let i = 1; i < arr.length; i++) {
        let target = i
        for (let j = i - 1; j >= 0; j--) {
          if (arr[target] < arr[j]) {
            [arr[target], arr[j]] = [arr[j], arr[target]]
            count++
            target = j
          }
        }
      }
      return count * 5
    }
  </script>
</body>

</html>